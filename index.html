<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>HVAC Panel (MQTT)</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 18px; background:#f1f1f1; }
    .wrap { max-width: 980px; }
    .top { display:grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    .card { padding: 14px; border: 2px solid #6b8e23; border-radius: 12px; background:#e6e6e6; }
    .row { display:flex; justify-content:space-between; align-items:center; gap:10px; padding:6px 0; }
    .val { font-weight: 800; }
    .muted { color:#555; font-size: .92rem; margin-top: 6px; }
    input { padding: 10px; border: 1px solid #bbb; border-radius: 10px; width: 170px; background:#fafafa; }
    button { padding: 10px 12px; border: 1px solid #bbb; border-radius: 10px; background: #f7f7f7; cursor: pointer; }
    button:active { transform: translateY(1px); }
    button:disabled { opacity:.55; cursor:not-allowed; }

    .btnrow { display:flex; flex-wrap: wrap; gap: 10px; align-items:center; }
    .btn-green { background: #dcfce7; border-color:#86efac; }
    .btn-red   { background: #fee2e2; border-color:#fca5a5; }
    .btn-blue  { background: #dbeafe; border-color:#93c5fd; }
    .btn-gray  { background: #f3f4f6; border-color:#d1d5db; }

    .hidden { display:none !important; }

    .pill { padding: 3px 10px; border-radius: 999px; border:1px solid #bbb; font-weight:800; font-size:.9rem; }
    .pill-ok { background:#dcfce7; border-color:#86efac; }
    .pill-bad{ background:#fee2e2; border-color:#fca5a5; }
    .pill-warn{ background:#fff7ed; border-color:#fdba74; }

    /* Login */
    .loginWrap { max-width: 420px; margin: 60px auto; }
    .loginCard { padding: 18px; border: 2px solid #6b8e23; border-radius: 12px; background:#e6e6e6; }
    .loginCard h2 { margin: 0 0 12px 0; }
    .loginCard .row { justify-content:flex-start; gap:12px; }
    .loginCard label { width: 110px; }
    .loginErr { color:#b00020; font-weight:700; margin-top:10px; min-height: 22px; }

    @media (max-width: 900px){
      .top { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<!-- LOGIN EKRANI -->
<div id="loginView" class="loginWrap">
  <div class="loginCard">
    <h2>üîí Giri≈ü</h2>
    <div class="row"><label>Kullanƒ±cƒ±</label><input id="loginUser" autocomplete="username"></div>
    <div class="row"><label>≈ûifre</label><input id="loginPass" type="password" autocomplete="current-password"></div>
    <div class="btnrow" style="margin-top:12px;">
      <button id="loginBtn" class="btn-green">Giri≈ü Yap</button>
      <button id="loginClearBtn">Temizle</button>
    </div>
    <div class="muted">Not: Bu giri≈ü ekranƒ± ≈üimdilik ‚Äúkapƒ±‚Äù ama√ßlƒ±dƒ±r (client-side).</div>
    <div id="loginErr" class="loginErr"></div>
  </div>
</div>

<!-- PANEL -->
<div id="panelView" class="wrap hidden">
  <div class="top">

    <div class="card">
      <div class="btnrow" style="justify-content:space-between;">
        <h2 style="margin:0;">üì° √ñl√ß√ºmler</h2>
        <div class="btnrow">
          <button id="minmaxBtn">Min/Max Sƒ±fƒ±rla</button>
          <button id="logoutBtn">√áƒ±kƒ±≈ü</button>
        </div>
      </div>

      <div class="row"><div>Durum</div><div class="val" id="conn">Baƒülanƒ±yor‚Ä¶</div></div>
      <div class="row"><div>Sƒ±caklƒ±k</div><div class="val" id="t">--</div></div>
      <div class="row"><div>Nem</div><div class="val" id="h">--</div></div>

      <div class="row"><div>Min/Max (T)</div><div class="val" id="tmm">--</div></div>
      <div class="row"><div>Min/Max (H)</div><div class="val" id="hmm">--</div></div>

      <div class="muted" id="clock">Saat: --</div>
      <div class="muted" id="lastSample">Son okuma: --</div>
      <div class="muted" id="ntp">NTP: --</div>
      <div class="muted" id="err" style="color:#8a5a00;"></div>
    </div>

    <div class="card">
      <h2>üéõÔ∏è Kontrol</h2>

      <div class="row"><div>Mod</div><div class="val" id="modeTxt">--</div></div>

      <!-- Kombi / Klima ger√ßek durum -->
      <div class="row">
        <div>Kombi (ACT)</div>
        <div class="val" id="kombiTxt">--</div>
      </div>
      <div class="row">
        <div>Klima (ACT)</div>
        <div class="val" id="klimaTxt">--</div>
      </div>

      <!-- Akt√ºat√∂r node durumlarƒ± -->
      <div class="row">
        <div>Kombi Node</div>
        <div class="val"><span id="kNodePill" class="pill">--</span> <span id="kNodeInfo" class="muted"></span></div>
      </div>
      <div class="row">
        <div>Klima Node</div>
        <div class="val"><span id="lNodePill" class="pill">--</span> <span id="lNodeInfo" class="muted"></span></div>
      </div>

      <div class="row">
        <div>Ayarlar</div>
        <div class="btnrow">
          <label>SP (¬∞C) <input id="sp" type="number" step="0.1" min="10" max="35"/></label>
          <label>Hys (¬∞C) <input id="hys" type="number" step="0.1" min="0.5" max="3.0"/></label>
          <button id="logicBtn" class="btn-blue">AC</button>
          <button id="saveBtn">Kaydet</button>
        </div>
      </div>

      <div class="btnrow" style="margin-top:8px;">
        <button id="modeBtn">AUTO</button>
        <button id="kombiBtn">KOMBI</button>
        <button id="klimaBtn">KLIMA</button>
      </div>

      <div class="muted" id="mismatchWarn"></div>

      <div class="muted">
        Not: MANUAL modda Kombi/Klima ayrƒ± ayrƒ± a√ßƒ±lƒ±r. AUTO modda logic‚Äôe g√∂re sadece biri √ßalƒ±≈üƒ±r.
      </div>
    </div>

  </div>
</div>

<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<script>
/* ===================== AYARLAR ===================== */
const BROKER_WSS = "wss://broker.emqx.io:8084/mqtt";

// Topic + key
const BASE_TOPIC = "omer/hvac/9f3a1c7b2d4e6f8a";
const CMD_KEY    = "K!n@l1_2026_x9Qp7v";

// ‚Äúkapƒ±‚Äù login (client-side)
const LOGIN_USER = "omer";
const LOGIN_PASS = "1234";

const T_TELE  = `${BASE_TOPIC}/tele`;
const T_STATE = `${BASE_TOPIC}/state`;
const T_CMD   = `${BASE_TOPIC}/cmd`;
const T_LWT   = `${BASE_TOPIC}/lwt`;

// Actuator topics (direct visibility)
const T_K_LWT   = `${BASE_TOPIC}/act/kombi/lwt`;
const T_K_STATE = `${BASE_TOPIC}/act/kombi/state`;
const T_L_LWT   = `${BASE_TOPIC}/act/klima/lwt`;
const T_L_STATE = `${BASE_TOPIC}/act/klima/state`;

/* ===================== DOM ===================== */
const loginView = document.getElementById("loginView");
const panelView = document.getElementById("panelView");
const loginUser = document.getElementById("loginUser");
const loginPass = document.getElementById("loginPass");
const loginBtn  = document.getElementById("loginBtn");
const loginClearBtn = document.getElementById("loginClearBtn");
const loginErr  = document.getElementById("loginErr");

const elConn = document.getElementById("conn");
const elT = document.getElementById("t");
const elH = document.getElementById("h");
const elTmm = document.getElementById("tmm");
const elHmm = document.getElementById("hmm");
const elClock = document.getElementById("clock");
const elLastSample = document.getElementById("lastSample");
const elNTP = document.getElementById("ntp");
const elErr = document.getElementById("err");

const elModeTxt = document.getElementById("modeTxt");
const elKombiTxt = document.getElementById("kombiTxt");
const elKlimaTxt = document.getElementById("klimaTxt");

const elKNodePill = document.getElementById("kNodePill");
const elLNodePill = document.getElementById("lNodePill");
const elKNodeInfo = document.getElementById("kNodeInfo");
const elLNodeInfo = document.getElementById("lNodeInfo");

const elSP = document.getElementById("sp");
const elHys = document.getElementById("hys");
const elLogicBtn = document.getElementById("logicBtn");
const elSaveBtn = document.getElementById("saveBtn");

const elModeBtn = document.getElementById("modeBtn");
const elKombiBtn = document.getElementById("kombiBtn");
const elKlimaBtn = document.getElementById("klimaBtn");

const logoutBtn = document.getElementById("logoutBtn");
const minmaxBtn = document.getElementById("minmaxBtn");

const elMisWarn = document.getElementById("mismatchWarn");

/* ===================== STATE ===================== */
let state = {
  mode: null, logic: "AC",
  sp: 25.0, hys: 1.0,
  kombi: 0, klima: 0,
  tz_off_s: 0, ntp_ok: 0, ts: 0,
  tmin: null, tmax: null, hmin: null, hmax: null,

  // added by MAIN:
  kombi_online: 0, klima_online: 0,
  kombi_cmd: 0, klima_cmd: 0,
  kombi_act: -1, klima_act: -1,
  kombi_mis: 0, klima_mis: 0,
  kombi_rssi: 0, klima_rssi: 0
};

// direct actuator visibility
let act = {
  k_online: null, k_state: null, k_rssi: null, k_ts: null, k_ip: null,
  l_online: null, l_state: null, l_rssi: null, l_ts: null, l_ip: null,
};

let dirtySP=false, dirtyHys=false;
let debounceT=null;

/* MQTT client */
let client = null;

/* ===================== ZAMAN ===================== */
function pad2(n){ return (n<10 ? "0"+n : ""+n); }
function fmtLocalNow(){
  const d = new Date();
  return pad2(d.getDate())+"/"+pad2(d.getMonth()+1)+"/"+d.getFullYear()+" "+
         pad2(d.getHours())+":"+pad2(d.getMinutes())+":"+pad2(d.getSeconds());
}
setInterval(()=>{ elClock.textContent = "Saat: " + fmtLocalNow(); }, 1000);

function fmtTRT(epochUtc, tzOffS){
  const dt = new Date((epochUtc + tzOffS) * 1000);
  return pad2(dt.getUTCDate())+"/"+pad2(dt.getUTCMonth()+1)+"/"+dt.getUTCFullYear()+" "+
         pad2(dt.getUTCHours())+":"+pad2(dt.getUTCMinutes())+":"+pad2(dt.getUTCSeconds());
}

/* ===================== UI HELPERS ===================== */
function setPill(el, text, kind){
  el.textContent = text;
  el.className = "pill " + (kind==="ok" ? "pill-ok" : kind==="bad" ? "pill-bad" : "pill-warn");
}
function fmtState01(v){
  if (v === 1) return "ON";
  if (v === 0) return "OFF";
  return "--";
}

function updateActuatorUI(){
  // Prefer direct actuator topics if present, else fallback to MAIN-provided
  const kOnline = (act.k_online != null) ? act.k_online : (state.kombi_online ? true : false);
  const lOnline = (act.l_online != null) ? act.l_online : (state.klima_online ? true : false);

  const kState = (act.k_state != null) ? act.k_state : (state.kombi_act >= 0 ? state.kombi_act : null);
  const lState = (act.l_state != null) ? act.l_state : (state.klima_act >= 0 ? state.klima_act : null);

  const kRssi = (act.k_rssi != null) ? act.k_rssi : state.kombi_rssi;
  const lRssi = (act.l_rssi != null) ? act.l_rssi : state.klima_rssi;

  if (kOnline === true) setPill(elKNodePill, "ONLINE", "ok");
  else if (kOnline === false) setPill(elKNodePill, "OFFLINE", "bad");
  else setPill(elKNodePill, "--", "warn");

  if (lOnline === true) setPill(elLNodePill, "ONLINE", "ok");
  else if (lOnline === false) setPill(elLNodePill, "OFFLINE", "bad");
  else setPill(elLNodePill, "--", "warn");

  elKNodeInfo.textContent = (kState==null ? "" : (" " + fmtState01(kState))) + (kRssi ? `  RSSI:${kRssi}` : "");
  elLNodeInfo.textContent = (lState==null ? "" : (" " + fmtState01(lState))) + (lRssi ? `  RSSI:${lRssi}` : "");

  // mismatch warning from MAIN (authoritative)
  const mis = (state.kombi_mis ? 1 : 0) || (state.klima_mis ? 1 : 0);
  if (mis){
    elMisWarn.textContent =
      `Uyarƒ±: √áƒ±kƒ±≈ü-mismatch var. ` +
      `Kombi(cmd=${fmtState01(state.kombi_cmd)} act=${fmtState01(state.kombi_act)}) ` +
      `Klima(cmd=${fmtState01(state.klima_cmd)} act=${fmtState01(state.klima_act)})`;
  } else {
    elMisWarn.textContent = "";
  }
}

/* ===================== UI ===================== */
function styleButtons(){
  // Mode button
  if (state.mode === "AUTO"){
    elModeBtn.className = "btn-green";
    elModeBtn.textContent = "AUTO";
  } else if (state.mode === "MANUAL"){
    elModeBtn.className = "btn-red";
    elModeBtn.textContent = "MANUAL";
  } else {
    elModeBtn.className = "btn-gray";
    elModeBtn.textContent = "AUTO";
  }
  elModeTxt.textContent = state.mode || "--";

  // Logic toggle
  if (state.logic === "AC"){
    elLogicBtn.className = "btn-blue";
    elLogicBtn.textContent = "AC";
  } else {
    elLogicBtn.className = "btn-red";
    elLogicBtn.textContent = "HEAT";
  }

  // Outputs (ACT)
  elKombiTxt.textContent = state.kombi ? "ON" : "OFF";
  elKlimaTxt.textContent = state.klima ? "ON" : "OFF";

  const manual = (state.mode === "MANUAL");
  elKombiBtn.disabled = !manual;
  elKlimaBtn.disabled = !manual;

  elKombiBtn.className = manual ? (state.kombi ? "btn-green":"btn-gray") : "btn-gray";
  elKlimaBtn.className = manual ? (state.klima ? "btn-green":"btn-gray") : "btn-gray";

  elKombiBtn.textContent = manual ? (state.kombi ? "KOMBI ON":"KOMBI OFF") : "KOMBI";
  elKlimaBtn.textContent = manual ? (state.klima ? "KLIMA ON":"KLIMA OFF") : "KLIMA";

  // Min/Max
  const tmm = (state.tmin==null || state.tmax==null) ? "--" : `${Number(state.tmin).toFixed(1)} / ${Number(state.tmax).toFixed(1)} ¬∞C`;
  const hmm = (state.hmin==null || state.hmax==null) ? "--" : `${Number(state.hmin).toFixed(1)} / ${Number(state.hmax).toFixed(1)} %`;
  elTmm.textContent = tmm;
  elHmm.textContent = hmm;

  updateActuatorUI();
}

/* ===================== MQTT CMD ===================== */
function publishCmd(obj){
  if (!client || !client.connected) return;
  obj.key = CMD_KEY;
  client.publish(T_CMD, JSON.stringify(obj), {qos:0, retain:false});
}

function scheduleAutoSave(){
  if (debounceT) clearTimeout(debounceT);
  debounceT = setTimeout(()=>{
    const sp = parseFloat(elSP.value);
    const hys = parseFloat(elHys.value);
    if (Number.isNaN(sp) || Number.isNaN(hys)) return;
    publishCmd({ sp, hys });
    dirtySP=false; dirtyHys=false;
  }, 700);
}

elSP.addEventListener("input", ()=>{ dirtySP=true; scheduleAutoSave(); });
elHys.addEventListener("input", ()=>{ dirtyHys=true; scheduleAutoSave(); });

elSaveBtn.addEventListener("click", ()=>{
  const sp = parseFloat(elSP.value);
  const hys = parseFloat(elHys.value);
  if (Number.isNaN(sp) || Number.isNaN(hys)) return;
  publishCmd({ sp, hys });
  dirtySP=false; dirtyHys=false;
});

elModeBtn.addEventListener("click", ()=>{
  const next = (state.mode === "AUTO") ? "MANUAL" : "AUTO";
  publishCmd({ mode: next });
});

elLogicBtn.addEventListener("click", ()=>{
  const next = (state.logic === "AC") ? "HEAT" : "AC";
  publishCmd({ logic: next });
});

elKombiBtn.addEventListener("click", ()=>{
  const next = state.kombi ? "OFF" : "ON";
  publishCmd({ kombi: next });
});

elKlimaBtn.addEventListener("click", ()=>{
  const next = state.klima ? "OFF" : "ON";
  publishCmd({ klima: next });
});

minmaxBtn.addEventListener("click", ()=>{
  publishCmd({ minmax: "RESET" });
});

/* ===================== MQTT START/STOP ===================== */
function mqttStart(){
  if (client) return;

  const clientId = "web_" + Math.random().toString(16).slice(2);
  client = mqtt.connect(BROKER_WSS, {
    clientId,
    clean: true,
    reconnectPeriod: 2000,
    connectTimeout: 8000,
    protocolVersion: 4
  });

  client.on("connect", ()=>{
    elConn.textContent = "BAƒûLANDI";
    elConn.style.color = "#0a7a2f";
    elErr.textContent = "";
    client.subscribe([T_TELE, T_STATE, T_LWT, T_K_LWT, T_K_STATE, T_L_LWT, T_L_STATE], {qos:0});
  });

  client.on("reconnect", ()=>{
    elConn.textContent = "Baƒülanƒ±yor‚Ä¶";
    elConn.style.color = "#333";
  });

  client.on("offline", ()=>{
    elConn.textContent = "KAPALI";
    elConn.style.color = "#b00020";
  });

  client.on("error", (e)=>{
    elErr.textContent = "MQTT hata: " + (e?.message || e);
  });

  client.on("message", (topic, payload)=>{
    let j=null;
    const ps = payload.toString();

    // LWT strings
    if (topic === T_K_LWT){
      act.k_online = (ps === "online") ? true : (ps === "offline") ? false : null;
      updateActuatorUI();
      return;
    }
    if (topic === T_L_LWT){
      act.l_online = (ps === "online") ? true : (ps === "offline") ? false : null;
      updateActuatorUI();
      return;
    }

    try { j = JSON.parse(ps); } catch(e){ return; }

    if (topic === T_K_STATE){
      if (j.state != null) act.k_state = Number(j.state);
      if (j.rssi != null) act.k_rssi = Number(j.rssi);
      if (j.ts != null) act.k_ts = Number(j.ts);
      if (j.ip != null) act.k_ip = String(j.ip);
      updateActuatorUI();
      return;
    }
    if (topic === T_L_STATE){
      if (j.state != null) act.l_state = Number(j.state);
      if (j.rssi != null) act.l_rssi = Number(j.rssi);
      if (j.ts != null) act.l_ts = Number(j.ts);
      if (j.ip != null) act.l_ip = String(j.ip);
      updateActuatorUI();
      return;
    }

    if (topic === T_TELE){
      if (j.t == null) elT.textContent = "--";
      else elT.textContent = Number(j.t).toFixed(1) + " ¬∞C";

      if (j.h == null) elH.textContent = "--";
      else elH.textContent = Number(j.h).toFixed(1) + " %";

      if (j.ts && j.tz_off_s != null){
        elLastSample.textContent = "Son okuma: " + fmtTRT(Number(j.ts), Number(j.tz_off_s));
      }

      elNTP.textContent = "NTP: " + (j.ntp_ok ? "OK" : "BEKLENƒ∞YOR");

      if (j.mode)  state.mode = j.mode;
      if (j.logic) state.logic = j.logic;
      if (j.sp != null)  state.sp = Number(j.sp);
      if (j.hys != null) state.hys = Number(j.hys);
      if (j.kombi != null) state.kombi = Number(j.kombi);
      if (j.klima != null) state.klima = Number(j.klima);

      // added fields
      if (j.kombi_online != null) state.kombi_online = Number(j.kombi_online);
      if (j.klima_online != null) state.klima_online = Number(j.klima_online);
      if (j.kombi_cmd != null) state.kombi_cmd = Number(j.kombi_cmd);
      if (j.klima_cmd != null) state.klima_cmd = Number(j.klima_cmd);
      if (j.kombi_act != null) state.kombi_act = Number(j.kombi_act);
      if (j.klima_act != null) state.klima_act = Number(j.klima_act);
      if (j.kombi_mis != null) state.kombi_mis = Number(j.kombi_mis);
      if (j.klima_mis != null) state.klima_mis = Number(j.klima_mis);
      if (j.kombi_rssi != null) state.kombi_rssi = Number(j.kombi_rssi);
      if (j.klima_rssi != null) state.klima_rssi = Number(j.klima_rssi);

      if (j.tz_off_s != null) state.tz_off_s = Number(j.tz_off_s);
      if (j.ntp_ok != null) state.ntp_ok = Number(j.ntp_ok);

      state.tmin = (j.tmin==null ? null : Number(j.tmin));
      state.tmax = (j.tmax==null ? null : Number(j.tmax));
      state.hmin = (j.hmin==null ? null : Number(j.hmin));
      state.hmax = (j.hmax==null ? null : Number(j.hmax));

      if (!dirtySP && document.activeElement !== elSP) elSP.value = state.sp.toFixed(1);
      if (!dirtyHys && document.activeElement !== elHys) elHys.value = state.hys.toFixed(1);

      styleButtons();
    }

    if (topic === T_STATE){
      if (j.mode)  state.mode = j.mode;
      if (j.logic) state.logic = j.logic;
      if (j.sp != null)  state.sp = Number(j.sp);
      if (j.hys != null) state.hys = Number(j.hys);

      // kombi/klima strings ON/OFF
      if (j.kombi != null) state.kombi = (j.kombi === "ON") ? 1 : 0;
      if (j.klima != null) state.klima = (j.klima === "ON") ? 1 : 0;

      // added fields
      if (j.kombi_online != null) state.kombi_online = Number(j.kombi_online);
      if (j.klima_online != null) state.klima_online = Number(j.klima_online);
      if (j.kombi_cmd != null) state.kombi_cmd = Number(j.kombi_cmd);
      if (j.klima_cmd != null) state.klima_cmd = Number(j.klima_cmd);
      if (j.kombi_act != null) state.kombi_act = Number(j.kombi_act);
      if (j.klima_act != null) state.klima_act = Number(j.klima_act);
      if (j.kombi_mis != null) state.kombi_mis = Number(j.kombi_mis);
      if (j.klima_mis != null) state.klima_mis = Number(j.klima_mis);
      if (j.kombi_rssi != null) state.kombi_rssi = Number(j.kombi_rssi);
      if (j.klima_rssi != null) state.klima_rssi = Number(j.klima_rssi);

      state.tmin = (j.tmin==null ? null : Number(j.tmin));
      state.tmax = (j.tmax==null ? null : Number(j.tmax));
      state.hmin = (j.hmin==null ? null : Number(j.hmin));
      state.hmax = (j.hmax==null ? null : Number(j.hmax));

      if (!dirtySP && document.activeElement !== elSP) elSP.value = state.sp.toFixed(1);
      if (!dirtyHys && document.activeElement !== elHys) elHys.value = state.hys.toFixed(1);

      styleButtons();
    }
  });
}

function mqttStop(){
  if (!client) return;
  try { client.end(true); } catch(e) {}
  client = null;
}

/* ===================== LOGIN FLOW ===================== */
function showLogin(){
  panelView.classList.add("hidden");
  loginView.classList.remove("hidden");
  loginErr.textContent = "";
  mqttStop();
}

function showPanel(){
  loginView.classList.add("hidden");
  panelView.classList.remove("hidden");
  mqttStart();
}

function doLogin(){
  const u = (loginUser.value || "").trim();
  const p = (loginPass.value || "");
  if (u === LOGIN_USER && p === LOGIN_PASS){
    localStorage.setItem("hvac_auth", "1");
    showPanel();
  } else {
    loginErr.textContent = "Hatalƒ± kullanƒ±cƒ± adƒ± veya ≈üifre.";
  }
}

loginBtn.addEventListener("click", doLogin);
loginPass.addEventListener("keydown", (e)=>{ if (e.key === "Enter") doLogin(); });

loginClearBtn.addEventListener("click", ()=>{
  loginUser.value = "";
  loginPass.value = "";
  loginErr.textContent = "";
});

logoutBtn.addEventListener("click", ()=>{
  localStorage.removeItem("hvac_auth");
  showLogin();
});

/* ƒ∞lk a√ßƒ±lƒ±≈ü */
if (localStorage.getItem("hvac_auth") === "1") showPanel();
else showLogin();
</script>

</body>
</html>
